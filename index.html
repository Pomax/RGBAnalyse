<!doctype html>
<html>
  <head>
    <meta charset="utf-8">
    <title>image analyser</title>
    <script src="release/RGBAnalyse.js"></script>
    <style>
      div img {
        display: inline-block;
        vertical-align: top;
        margin: 1em;
      }
      div div {
        display: inline-block;
      }
      div div img {
        display: block;
      }
      img.histogram.visualisation {
        width: 200px;
        height: 200px;
        background: white;
        border: 1px solid black;
      }
      img.spectrum.visualisation {
        width: 200px;
        height: 50px;
        background: white;
        border: 1px solid black;
      }
    </style>
  </head>
  <body>
    <h1>A client-side histogram library for same-origin images</h1>
    <p><A href="http://github.com/Pomax/RGBAnalyse">by Pomax</a></p>
    <script>
      function analyse(img) {
        RGBAnalyse.analyse(img, function(err, analysis) {
          var bin = img.parentNode;
          var div = document.createElement("div");

          var viz = new Image();
          viz.src = analysis.visualization.histogram;
          viz.setAttribute("class", "histogram visualisation");
          div.appendChild(viz);

          var viz = new Image();
          viz.src = analysis.visualization.spectrum;
          viz.setAttribute("class", "spectrum visualisation");
          div.appendChild(viz);

          bin.appendChild(div);
        });
      };

      function buildImage(idx) {
        idx = (idx<10) ? '0' + idx : idx;
        var img = new Image();
        var div = document.createElement("div");
        div.appendChild(img);
        img.onload = function(evt) {
          var img = evt.target;
          setTimeout(function() { analyse(img); }, 100);
        };
        img.src = "images/img" + idx + ".jpg";
        document.body.appendChild(div);
      }

      for(var i=1; i<=17; i++) { buildImage(i); }
    </script>
  </body>
</html>